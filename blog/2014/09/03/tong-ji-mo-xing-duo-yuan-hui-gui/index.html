
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang=""><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>《统计模型：理论与实践》第四章：多元回归-读书笔记 - 玩儿数据</title>
  <meta name="author" content="王轶楠">
  
  
  <meta name="description" content="统计模型：理论与实践 第四章：多元回归 笔记">
  <meta name="keywords" content="统计模型 多元回归">
  <meta property="og:title" content="《统计模型：理论与实践》第四章：多元回归-读书笔记" />
  <meta property="og:type" content="blog" />
  <meta property="og:description" content="统计模型：理论与实践 第四章：多元回归 笔记">
  
  <meta property="og:url" content="http://wangyinanchina.github.io/blog/2014/09/03/tong-ji-mo-xing-duo-yuan-hui-gui/" />
  
  
  
  
  
  
  
  
  <meta property="og:site_name" content="玩儿数据" />
  <meta property="fb:admins" content="" />
  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="canonical" href="http://wangyinanchina.github.io/blog/2014/09/03/tong-ji-mo-xing-duo-yuan-hui-gui/">
  <link href="/favicon.png" rel="icon">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="玩儿数据" type="application/atom+xml">
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
        inlineMath: [ ['$$$', '$$$'], ["\\(", "\\)"] ],
        displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
      //,
      //displayAlign: "left",
      //displayIndent: "2em"
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='//fonts.googleapis.com/css?family=Black+Ops+One' rel='stylesheet' type='text/css'>


  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js"></script>
  <!--[if lt IE 9]>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <![endif]-->
  <!--[if gte IE 9]><!-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
  
  <!--<![endif]-->
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/footnote.js"></script>
  
  <script src="/javascripts/jquery.exflexfixed-0.3.0.js"></script>
  <script src="/javascripts/jquery.nailthumb.1.1.min.js"></script>
  <script src="/javascripts/jquery.githubRepoWidget.min.js"></script>
  <script src="/javascripts/monthly_archive.js"></script>
  <script src="/javascripts/utils.js"></script>
  
</head>

<body   >
  <header role="banner"><h1>
  <a href="/">
  
  玩儿数据
  </a>
</h1>

  <h2>少年王二狗的欢乐生活</h2>


</header>
  <nav role="navigation"><div class="main-navigation">
  
  <p>
    <p>
  <a href="/" class="link_btn" >博客</a>
  <a href="/about/" class="link_btn" >关于我</a>
  <a href="/projects/" class="link_btn" >在做</a>
</p>

  </p>
  
  <p>
    <form action="https://www.google.com/search" method="get">
      <fieldset role="search">
        <input type="hidden" name="q" value="site:wangyinanchina.github.io" />
        <input class="search" type="text" name="q" results="0" placeholder="Search"/>
      </fieldset>
    </form>
  </p>
  
  
  <p>
    

  </p>
  
  
</div>
</nav>
  <div id="main">
    <div id="content">
      <div><!-- post -->
<article class="hentry" role="article" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
  

<!--
<rdf:RDF
xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:foaf="http://xmlns.com/foaf/0.1/">
<rdf:Description rdf:about="http://wangyinanchina.github.io/blog/2014/09/03/tong-ji-mo-xing-duo-yuan-hui-gui/">
<foaf:maker rdf:parseType="Resource">
<foaf:holdsAccount>
<foaf:OnlineAccount foaf:accountName="">
<foaf:accountServiceHomepage rdf:resource="http://www.hatena.ne.jp/">
</foaf:accountServiceHomepage>
</foaf:OnlineAccount>
</foaf:holdsAccount>
</foaf:maker>
</rdf:Description>
</rdf:RDF>
&#8211;>




<article>
  

</article>


  <!-- google_ad_section_start -->
  
<header>
  
  <p class="meta">
    








  



<time datetime="2014-09-03T17:16:23+08:00" pubdate data-updated="true" itemprop="datePublished dateCreated"></time>
    

<span class="categories">
  Posted in
  
    <a class='category' href='/blog/categories/duo-yuan-hui-gui/'>多元回归</a>, <a class='category' href='/blog/categories/tong-ji-mo-xing/'>统计模型</a>
  
</span>


    


  </p>
  
  
  
  <h1 class="entry-title" itemprop="name headline">《统计模型：理论与实践》第四章：多元回归-读书笔记</h1>
  
  
  
</header>


<div class="sharing">
  <ul>
    
    
    
    
    
    
    
    
  </ul>
</div>




<div class="entry-content">
  <div class="group">
    
    <p>多元回归和单变量回归类似，目的是探索自变量和因变量的关系，以及对因变量的取值给予预测。</p>


  </div>
  <!-- more -->
  <div class="group">
    <p>多元回归和单变量回归类似，目的是探索自变量和因变量的关系，以及对因变量的取值给予预测。</p>

<!--more-->


<p>由于多元回归包含多个自变量，因此要复杂一些。通常情况下，我们假设自变量为矩阵$$$X$$$，因变量向量为$$$Y$$$，随机误差为$$$\epsilon$$$，那么，我们认为他们之间的关系是：$$Y = X\beta + \epsilon \qquad(1)$$
显然$$$X, Y, \beta以及\epsilon$$$都是随机变量，我们往往能够从数据中得到$$$X$$$和$$$Y$$$的一些观测值，但是仅有这些并不足以使我们推断出$$$\beta$$$，例如我们可以使$$$\beta$$$为任意值，只要调整$$$\epsilon$$$即可。所以，我们还需要一些假设来帮助我们推断$$$\beta$$$。通常我们假设：$$X与\epsilon独立，即X\perp\perp\epsilon \qquad(2)$$
以及$$\epsilon_i独立同分布, 期望为0，方差为\sigma^{2} \qquad(3)$$</p>

<p>以上两个假设对$$$\epsilon$$$的取值做了限制，使得我们有可能去估计$$$\beta$$$。通常我们选择OLS估计量$$$\widehat{\beta} = (X&#8217;X)^{-1}X&#8217;Y$$$来估计$$$\beta$$$，并且定义残差为:$$e = Y - X\widehat{\beta} \qquad(4)$$
可以证明，当<a href="http://wangyinanchina.github.io/blog/2014/09/03/prove-beta-ols/">$$$\beta = \widehat{\beta}时，sum(e^{2})最小$$$</a>,并且$$$e和X正交，即e\perp X$$$.
在这里，需要注意e和$$$\epsilon$$$的区别: $$$\epsilon$$$是随机误差，无法观测，也无法估计，我们只能假定它的分布、期望和方差。而e是可以观测的，当我们得到$$$\widehat{\beta}$$$之后，我们也就得到了e，并且通常会用e的平方和的大小去评价一个回归模型的好坏。除此之外，$$$\epsilon$$$与$$$X$$$ 独立而不一定正交，而$$$e与X$$$ 正交，但并不独立。</p>

<p>$$$\widehat{\beta}$$$的另一个重要性质是它是条件无偏的，即$$$E(\widehat{\beta}|X) = \beta$$$。证明过程如下：</p>

<blockquote><p>$$E(\widehat{\beta}|X) = E((X&#8217;X)^{-1}X&#8217;Y|X) = (X&#8217;X)^{-1}X&#8217;E(X\beta + \epsilon|X) = (X&#8217;X)^{-1}X&#8217;X\beta = \beta$$</p></blockquote>

<p>得到$$$\widehat{\beta}$$$后，我们自然要关注其误差是多少，这样我们可以对估计值的波动范围有一个了解。我们可以计算出，$$$cov(\widehat{\beta}|X) = \sigma^{2}(X&#8217;X)^{-1}$$$，计算过程如下:</p>

<blockquote><p>已知$$\widehat{\beta} = (X&#8217;X)^{-1}X&#8217;Y = (X&#8217;X)^{-1}X&#8217;(X\beta + \epsilon) = \beta + (X&#8217;X)^{-1}X&#8217;\epsilon\qquad(5)$$
所以，$$cov(\widehat{\beta}|X) = (X&#8217;X)^{-1}X&#8217;cov(\epsilon|X)X(X&#8217;X)^{-1} = \sigma^{2}(X&#8217;X)^{-1}\qquad(6)$$
原式得证。</p></blockquote>

<p>但是$$$\sigma^{2}$$$是无法观测的，所以我们必须得到$$$\widehat{\sigma^{2}}$$$，通常我们使用e&#8217;e来估计$$$\widehat{\sigma^{2}}$$$，由于e一般要比$$$\epsilon$$$要小（因为估计$$$\beta$$$的时候我们选择使e&#8217;e最小的$$$\beta$$$），所以我们将e&#8217;e除以自由度n - p来更好的估计$$$\widehat{\sigma^{2}}$$$，即：$$$\widehat{\sigma^{2}} = 1/(n - p) * e&#8217;e$$$。可以证明，$$$E(\widehat{\sigma}^2|X) = \sigma^{2}$$$，证明过程如下：</p>

<blockquote><p>已知$$E(\widehat{\sigma}^2|X) = 1/(n - p) * E(e&#8217;e|X)\qquad(7)$$，定义$$$H = X(X&#8217;X)^{-1}X&#8217;$$$，易见H是对称幂等矩阵，则$$e = Y - X\widehat{\beta} = (I - H)Y = (I - H)(X\beta + \epsilon) = (I -H)\epsilon\qquad(8)$$
所以$$e&#8217;e = \epsilon&#8217;(I - H)&lsquo;(I - H)\epsilon = \epsilon&rsquo;(I - H)\epsilon = \sum_{i = 1}^{n}\sum_{j = 1}^{n}\epsilon_{i}(I - H)_{ij}\epsilon_{j}\qquad(9)$$
所以$$E(\widehat{\sigma}^2|X) = E(\sum_{i = 1}^{n}\sum_{j = 1}^{n}\epsilon_{i}(I - H)_{ij}\epsilon_{j}|X) = \sum_{i = 1}^{n}\sum_{j = 1}^{n}(I - H)_{ij}E(\epsilon_{i}\epsilon_{j}|X)\qquad(10)$$
又因为$$$\epsilon$$$和X相互独立，且$$$\epsilon$$$独立同分布，所以$$E(\epsilon_{i}\epsilon_{i}|X) = \sigma^{2}, E(\epsilon_{i}\epsilon_{j}|X) = 0\qquad(11)$$
所以，$$\sum_{i = 1}^{n}\sum_{j = 1}^{n}(I - H)_{ij}E(\epsilon_{i}\epsilon_{j}|X) = \sigma^{2} trace(I -H) = \sigma^{2} (n - trace(X(X&#8217;X)^{-1}X&#8217;)) = (n - p)\sigma^{2}\qquad(12)$$
将（12）带入（7），即可得到$$$E(\widehat{\sigma}^2|X) = \sigma^{2}$$$</p></blockquote>

<p>所以，综上所述我们最终得到$$$\widehat{\beta}$$$的误差为:$$\widehat{cov}(\widehat{\beta}|X) = \widehat{\sigma}^{2}(X&#8217;X)^{-1}\qquad(13)$$</p>

<p>接下来我们需要考虑的问题是，我们的模型到底拟合的好不好。可以证明，假定方程有截距，那么$$$var(Y) = var(X\widehat{\beta}) + var(e)$$$，证明过程如下：</p>

<blockquote><p>令$$$u = I_{n * 1}$$$, 则$$$Y - \bar{Y}u = X\widehat{\beta} - \bar{Y}u + e$$$, 又因为e正交于X和u，那么，
$$||Y - \bar{Y}u||^{2} = ||X\widehat{\beta} - \bar{Y}u||^{2} + ||e||^{2}\qquad(14)$$
又因为$$$||X\widehat{\beta} - \bar{Y}u||^{2} = nvar(Y)$$$, $$$||X\widehat{\beta} - \bar{Y}u||^{2} = ||X\widehat{\beta} - \bar{X}\widehat{\beta}u||^{2} = nvar(X\widehat{\beta})$$$, $$$||e||^{2} = nvar(e)$$$，代入(14)，命题得证。</p></blockquote>

<p>因此我们看出可以把Y的波动分为两部分，一部分和自变量相关，一部分和残差相关。显然和残差相关的波动越小，说明我们拟合的模型和观测值越接近，因此我们定义了:
$$R^{2} = var(X\widehat{\beta}) / var(Y)\qquad(15)$$
来度量模型的拟合度。根据$$$R^{2}$$$的定义式，我们也称其为被解释的方差。但是，需要注意的是，$$$R^{2}$$$只能说明模型拟合的程度，仅仅依据$$$R^{2}$$$我们无法得到任何因果相关的结论。</p>

  </div>
</div>
<!-- </div><footer> * pseudo line for the function raw_content() &#8211;>



  <!-- google_ad_section_end -->
  <footer>
    
    <p class="meta">
      
  

<span class="byline author vcard" itemscope itemtype="http://schema.org/Person">Posted by <span class="fn" itemprop="name">王轶楠</span></span>

      








  



<time datetime="2014-09-03T17:16:23+08:00" class="updated"  data-updated="true" itemprop="dateModified"></time>
      

<span class="categories">
  Posted in
  
    <a class='category' href='/blog/categories/duo-yuan-hui-gui/'>多元回归</a>, <a class='category' href='/blog/categories/tong-ji-mo-xing/'>统计模型</a>
  
</span>


      


    </p>
    
    <div class="related_posts">
<h3>You may also like&#8230;</h3>
<ul>

<li><a href="/blog/2014/09/11/pgm-chap2-graph/">概率图模型：第二章(图论部分)-读书笔记</a></li>

<li><a href="/blog/2014/09/10/pgm-chap-2/">概率图模型：第二章(概率论部分)-读书笔记</a></li>

<li><a href="/blog/2014/09/08/statistical-model-chap-5/">统计模型：理论与实践 第五章：多元回归-特别主题 读书笔记</a></li>

<li><a href="/blog/2014/09/03/fishers-exact-test/">超几何分布和fisher精确检验</a></li>

<li><a href="/blog/2014/09/03/octopress-mou/">解决mou中inline公式在octopress中显示混乱的问题</a></li>

</ul>
</div>

    
    
    
<div class="sharing">
  <ul>
    
    
    
    
    
    
    
    
  </ul>
</div>

    
    <p class="meta">
      
      
      <a class="basic-alignment right" href="/blog/2014/09/03/prove-beta-ols/" title="Next Post: 证明多元回归系数的最小二乘性">证明多元回归系数的最小二乘性 &raquo;</a>
      
    </p>
  </footer>
</article>


<section>


</section>




<div class="center_wrapper">
  

</div>




<section>


</section>


</div><!-- post -->

<aside class="sidebar">
  
  <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/09/11/pgm-chap2-graph/">概率图模型：第二章(图论部分)-读书笔记</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/10/pgm-chap-2/">概率图模型：第二章(概率论部分)-读书笔记</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/08/statistical-model-chap-5/">统计模型：理论与实践 第五章：多元回归-特别主题 读书笔记</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/03/fishers-exact-test/">超几何分布和fisher精确检验</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/03/octopress-mou/">解决mou中inline公式在octopress中显示混乱的问题</a>
      </li>
    
  </ul>
</section>


<section>
    <h1>新浪微博</h1>
    <ul id="weibo">
    <li>

    <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=1&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=2566704070&verifier=88353b6d&dpc=1"></iframe>

      </li>
    </ul>
</section><section>
  <h1>My Douban</h1>
  <div>
  <script type="text/javascript" src="http://www.douban.com/service/badge/81291132/?selection=latest&amp;picsize=small&amp;show=collection&amp;n=4&amp;cat=movie%7Cbook&amp;columns=2"></script>
  </div>
</section><section>
  <h1>访客地图</h1>
  <script type="text/javascript" src="http://jb.revolvermaps.com/2/1.js?i=1a5xbkbfrmf&amp;s=220&amp;m=2&amp;v=true&amp;r=false&amp;b=000000&amp;n=true&amp;c=ff0000" async="async"></script>
</section>
  
</aside>


    </div><!-- content -->
  </div><!-- main -->
  <footer role="contentinfo"><script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F4a4b9b6bddc7a510f463a73370180219' type='text/javascript'%3E%3C/script%3E"));
</script>


<div class="center_wrapper">
  <div>
    <a href="mailto:Yinan.wang@pku.edu.cn">Contact</a>, <a href="/privacy/">Privacy Policy</a>
  </div>
  <div>
    Copyright &copy; 2014 - 王轶楠 -
    <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
    <span class="credit">, with theme <a href="https://github.com/rcmdnk/octogray">octogray</a></span>
  </div>
</div>

</footer>
  
<script type="text/javascript">

(function (w, d) {
  var j, s = d.getElementsByTagName('script')[0],
  a = function (u, i) {
    if (!d.getElementById(i)) {
      j = d.createElement('script');
      j.src = u;
      if (i) {j.id = i;}
      s.parentNode.insertBefore(j, s);
    }
  };
  
  
  
  
  
  
  
  
  
  
})(this, document);
</script>




</body>
</html>
