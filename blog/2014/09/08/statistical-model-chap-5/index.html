
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang=""><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>统计模型：理论与实践 第五章：多元回归-特别主题 读书笔记 - 玩儿数据</title>
  <meta name="author" content="王轶楠">
  
  
  <meta name="description" content="统计模型：理论与实践 第五章：多元回归-特别主题 笔记">
  <meta name="keywords" content="统计模型 多元回归 广义最小二乘">
  <meta property="og:title" content="统计模型：理论与实践 第五章：多元回归-特别主题 读书笔记" />
  <meta property="og:type" content="blog" />
  <meta property="og:description" content="统计模型：理论与实践 第五章：多元回归-特别主题 笔记">
  
  <meta property="og:url" content="http://wangyinanchina.github.io/blog/2014/09/08/statistical-model-chap-5/" />
  
  
  
  
  
  
  
  
  <meta property="og:site_name" content="玩儿数据" />
  <meta property="fb:admins" content="" />
  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="canonical" href="http://wangyinanchina.github.io/blog/2014/09/08/statistical-model-chap-5/">
  <link href="/favicon.png" rel="icon">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="玩儿数据" type="application/atom+xml">
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
        inlineMath: [ ['$$$', '$$$'], ["\\(", "\\)"] ],
        displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
      //,
      //displayAlign: "left",
      //displayIndent: "2em"
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='//fonts.googleapis.com/css?family=Black+Ops+One' rel='stylesheet' type='text/css'>


  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js"></script>
  <!--[if lt IE 9]>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <![endif]-->
  <!--[if gte IE 9]><!-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
  
  <!--<![endif]-->
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/footnote.js"></script>
  
  <script src="/javascripts/jquery.exflexfixed-0.3.0.js"></script>
  <script src="/javascripts/jquery.nailthumb.1.1.min.js"></script>
  <script src="/javascripts/jquery.githubRepoWidget.min.js"></script>
  <script src="/javascripts/monthly_archive.js"></script>
  <script src="/javascripts/utils.js"></script>
  
</head>

<body   >
  <header role="banner"><h1>
  <a href="/">
  
  玩儿数据
  </a>
</h1>

  <h2>少年王二狗的欢乐生活</h2>


</header>
  <nav role="navigation"><div class="main-navigation">
  
  <p>
    <p>
  <a href="/" class="link_btn" >博客</a>
  <a href="/about/" class="link_btn" >关于我</a>
  <a href="/projects/" class="link_btn" >在做</a>
</p>

  </p>
  
  <p>
    <form action="https://www.google.com/search" method="get">
      <fieldset role="search">
        <input type="hidden" name="q" value="site:wangyinanchina.github.io" />
        <input class="search" type="text" name="q" results="0" placeholder="Search"/>
      </fieldset>
    </form>
  </p>
  
  
  <p>
    

  </p>
  
  
</div>
</nav>
  <div id="main">
    <div id="content">
      <div><!-- post -->
<article class="hentry" role="article" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
  

<!--
<rdf:RDF
xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:foaf="http://xmlns.com/foaf/0.1/">
<rdf:Description rdf:about="http://wangyinanchina.github.io/blog/2014/09/08/statistical-model-chap-5/">
<foaf:maker rdf:parseType="Resource">
<foaf:holdsAccount>
<foaf:OnlineAccount foaf:accountName="">
<foaf:accountServiceHomepage rdf:resource="http://www.hatena.ne.jp/">
</foaf:accountServiceHomepage>
</foaf:OnlineAccount>
</foaf:holdsAccount>
</foaf:maker>
</rdf:Description>
</rdf:RDF>
&#8211;>




<article>
  

</article>


  <!-- google_ad_section_start -->
  
<header>
  
  <p class="meta">
    








  



<time datetime="2014-09-08T21:28:48+08:00" pubdate data-updated="true" itemprop="datePublished dateCreated"></time>
    

<span class="categories">
  Posted in
  
    <a class='category' href='/blog/categories/duo-yuan-hui-gui/'>多元回归</a>, <a class='category' href='/blog/categories/tong-ji-mo-xing/'>统计模型</a>
  
</span>


    


  </p>
  
  
  
  <h1 class="entry-title" itemprop="name headline">统计模型：理论与实践 第五章：多元回归-特别主题 读书笔记</h1>
  
  
  
</header>


<div class="sharing">
  <ul>
    
    
    
    
    
    
    
    
  </ul>
</div>




<div class="entry-content">
  <div class="group">
    
    <p>在多元回归模型：$$Y = X\beta + \epsilon\qquad(1)$$
中，
  </div>
  <!-- more -->
  <div class="group">
    <p>在多元回归模型：$$Y = X\beta + \epsilon\qquad(1)$$
中，<!--more-->我们通常假定：1、$$$\epsilon$$$独立同分布；2、$$$\epsilon有均值0和方差\sigma^{2}$$$。在这一章，我们要讨论的问题是，如果$$$\epsilon_{i}$$$之间不独立，而是服从假定：$$E(\epsilon|X) = 0_{n*1}, \quad cov(\epsilon|X) = \sigma^{2}I_{n*n} \qquad(2)$$
将对多元回归产生怎样的影响。</p>

<p>下面将不加证明的给出</p>

<blockquote><h4>Gauss-Markov定理:</h4>

<p>假定X是非随机的，即$$$E(\epsilon) = 0_{n*1}, \quad cov(\epsilon) = \sigma^{2}I_{n*n}$$$,那么OLS估计量，即$$$\widehat{\beta} = (X&#8217;X)^{-1}X&#8217;Y$$$估计量是BLUE（最好线性无偏估计量，此时$$$var(\widehat{\beta})$$$最小）。</p></blockquote>

<p>如果我们将约束条件变得更加严格一些，即$$E(\epsilon|X) = 0_{n*1},\quad cov(\epsilon|X) = G,\quad G是n*n的正定矩阵\qquad(3)$$
这就是一个GLS回归模型。此时，相对于一般的回归模型，有以下两个区别：</p>

<blockquote><ul>
<li>$$$\widehat{\beta}_{OLS}不再是BLUE（最好线性无偏估计量）$$$</li>
<li>$$$cov(\widehat{\beta}_{OLS}|X) = (X&#8217;X)^{-1}X&#8217;GX(X&#8217;X)^{-1}$$$</li>
</ul>
</blockquote>

<p>为了解决$$$\widehat{\beta}_{OLS}不再是BLUE（最好线性无偏估计量）$$$的问题，我们可以将(1)左乘$$$G^{-&frac12;}$$$，则此时方程满足(2)，那么我们可以得到：
$$\widehat{\beta}_{GLS} = (X&#8217;G^{-1}X)^{-1}X&#8217;G^{-1}Y\qquad(4)$$
可以证明$$$\widehat{\beta}_{GLS}$$$条件无偏以及在X固定的情况下，$$$\widehat{\beta}_{GLS}$$$是BLUE。此时，可以计算出：
$$cov(\widehat{\beta}_{GLS}|X) = cov((X&#8217;G^{-1}X)^{-1}X&#8217;G^{-1}(X\beta +\epsilon)|X) = (X&#8217;G^{-1}X)^{-1}X&#8217;G^{-1}GG^{-1}X(X&#8217;G^{-1}X)^{-1} = (X&#8217;G^{-1}X)^{-1}\qquad(5)$$</p>

<p>在通常情况下，G未知，需要通过数据来估计。假设G是一个n*n的矩阵，那么我们要估计n*n个参数，这样待估计的参数远远超过了n个数据点，所以我们需要对G做出相应的约束。通常可以做出两种约束：</p>

<ul>
<li>认为$$$G=\lambda\Gamma$$$，其中$$$\Gamma$$$是固定的正定矩阵，所以我们只需要估计$$$\lambda$$$，$$$\lambda$$$可以用均方残差来估计</li>
<li>认为G的对角线是2*2的正定矩阵K，这样我们只需要估计$$$K_{11},K_{12},K_{22}$$$。</li>
</ul>


<p><strong>综上可以发现，实际上$$$\widehat{\beta}_{OLS}和\widehat{\beta}_{GLS}在给定X的情况下都是无偏的，我们考虑\widehat{\beta}_{GLS}的主要原因是\widehat{\beta}_{OLS}在该情况下非BLUE$$$。</strong></p>

<p>假设X是n*p矩阵，有时候并不是所有p个变量都对结果有影响。所以我们需要检验对应于$$$X_{i}的\beta_{i}$$$是否显著。对于OLS模型，我们使用t分布来做这个检验。首先我们定义t分布：</p>

<blockquote><p>设随机变量$$$U_{1},U_{2},&hellip;为IID（独立同分布）N(0,1),则\sum_{i=1}^{d}U_{i}^{2}服从自由度为d的卡方分布\chi_{d}^{2}，则\frac{U_{d+1}}{\sqrt{d^{-1}\sum_{i=1}^{d}U_{i}^{2}}}服从自由度为d的t分布$$$</p></blockquote>

<p>接下来我们不加证明的给出一个定理：</p>

<blockquote><p>如果误差是IID $$$N(0, \sigma^{2})$$$分布，那么$$$\widehat{\beta}_{OLS}服从均值为\beta,协方差矩阵为\sigma^{2}(X&#8217;X)^{-1}$$$，而且$$$e和\widehat{\beta}_{OLS}独立，||e||^{2} 服从 \sigma^{2}\chi_{d}^{2}，其中d=n-p$$$</p></blockquote>

<p>根据上述定理，我们可以得到推论：</p>

<blockquote><p>对于零假设：$$$\beta_{k}=0, t=\widehat{\beta}_{k}/\widehat{SE}$$$服从自由度为n-p的t分布,其中$$$\widehat{SE}=\sqrt{\widehat{\sigma}*(X&#8217;X)^{-1}_{kk}}$$$</p></blockquote>

<p>这样的话，我们就可以用t分布来对零假设进行假设检验了。</p>

<p>如果要检验多个$$$\widehat{\beta}_{i}$$$是否为0，我们则选用F检验，检验的方法如下：</p>

<blockquote><p>设我们有OLS模型，如式（1），X满秩，为n*p矩阵。我们要检验<strong>零假设</strong>:p个$$$\widehat{\beta}_{i}中前p_{0}个不为0，从p_{0}+1起均为0$$$。我们需要首先计算（1）的$$$\widehat{\beta}$$$，再计算满足0假设的$$$\widehat{\beta}^{(s)}$$$，则检验统计量为：
$$F=\frac{(||X\widehat{\beta}||^{2}-||X\widehat{\beta}^{(s)}||^{2})/p_{0}}{||e||^{2}/(n-p)}$$
这里不加证明的给出一个结论：在零假设下，F服从Fisher F分布。</p></blockquote>

<p>这一章的最后一部分讲的是统计显著的结果也可能是不可靠的。这很容易想象，因为如果我们设定显著为0.05，那么即使零假设是对的，我们也有0.05的可能得到一个显著地结果，例如100次试验可以得到5次假阳性。除此之外，我们在做回归的时候，如果我们先用所有的变量进行回归，进而剔除掉为系数为零的变量，用剩下的变量来对模型进行回归，我们可能会得到一个比较好的$$$R^{2}$$$，但是这往往不够可靠。</p>

  </div>
</div>
<!-- </div><footer> * pseudo line for the function raw_content() &#8211;>



  <!-- google_ad_section_end -->
  <footer>
    
    <p class="meta">
      
  

<span class="byline author vcard" itemscope itemtype="http://schema.org/Person">Posted by <span class="fn" itemprop="name">王轶楠</span></span>

      








  



<time datetime="2014-09-08T21:28:48+08:00" class="updated"  data-updated="true" itemprop="dateModified"></time>
      

<span class="categories">
  Posted in
  
    <a class='category' href='/blog/categories/duo-yuan-hui-gui/'>多元回归</a>, <a class='category' href='/blog/categories/tong-ji-mo-xing/'>统计模型</a>
  
</span>


      


    </p>
    
    <div class="related_posts">
<h3>You may also like&#8230;</h3>
<ul>

<li><a href="/blog/2014/09/11/pgm-chap2-graph/">概率图模型：第二章(图论部分)-读书笔记</a></li>

<li><a href="/blog/2014/09/10/pgm-chap-2/">概率图模型：第二章(概率论部分)-读书笔记</a></li>

<li><a href="/blog/2014/09/03/fishers-exact-test/">超几何分布和fisher精确检验</a></li>

<li><a href="/blog/2014/09/03/octopress-mou/">解决mou中inline公式在octopress中显示混乱的问题</a></li>

<li><a href="/blog/2014/09/03/prove-beta-ols/">证明多元回归系数的最小二乘性</a></li>

</ul>
</div>

    
    
    
<div class="sharing">
  <ul>
    
    
    
    
    
    
    
    
  </ul>
</div>

    
    <p class="meta">
      
      <a class="basic-alignment left" href="/blog/2014/09/03/fishers-exact-test/" title="Previous Post: 超几何分布和fisher精确检验">&laquo; 超几何分布和fisher精确检验</a>
      
      
      <a class="basic-alignment right" href="/blog/2014/09/10/pgm-chap-2/" title="Next Post: 概率图模型：第二章(概率论部分)-读书笔记">概率图模型：第二章(概率论部分)-读书笔记 &raquo;</a>
      
    </p>
  </footer>
</article>


<section>


</section>




<div class="center_wrapper">
  

</div>




<section>


</section>


</div><!-- post -->

<aside class="sidebar">
  
  <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/09/11/pgm-chap2-graph/">概率图模型：第二章(图论部分)-读书笔记</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/10/pgm-chap-2/">概率图模型：第二章(概率论部分)-读书笔记</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/08/statistical-model-chap-5/">统计模型：理论与实践 第五章：多元回归-特别主题 读书笔记</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/03/fishers-exact-test/">超几何分布和fisher精确检验</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/03/octopress-mou/">解决mou中inline公式在octopress中显示混乱的问题</a>
      </li>
    
  </ul>
</section>


<section>
    <h1>新浪微博</h1>
    <ul id="weibo">
    <li>

    <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=1&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=2566704070&verifier=88353b6d&dpc=1"></iframe>

      </li>
    </ul>
</section><section>
  <h1>My Douban</h1>
  <div>
  <script type="text/javascript" src="http://www.douban.com/service/badge/81291132/?selection=latest&amp;picsize=small&amp;show=collection&amp;n=4&amp;cat=movie%7Cbook&amp;columns=2"></script>
  </div>
</section><section>
  <h1>访客地图</h1>
  <script type="text/javascript" src="http://jb.revolvermaps.com/2/1.js?i=1a5xbkbfrmf&amp;s=220&amp;m=2&amp;v=true&amp;r=false&amp;b=000000&amp;n=true&amp;c=ff0000" async="async"></script>
</section>
  
</aside>


    </div><!-- content -->
  </div><!-- main -->
  <footer role="contentinfo"><script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F4a4b9b6bddc7a510f463a73370180219' type='text/javascript'%3E%3C/script%3E"));
</script>


<div class="center_wrapper">
  <div>
    <a href="mailto:Yinan.wang@pku.edu.cn">Contact</a>, <a href="/privacy/">Privacy Policy</a>
  </div>
  <div>
    Copyright &copy; 2014 - 王轶楠 -
    <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
    <span class="credit">, with theme <a href="https://github.com/rcmdnk/octogray">octogray</a></span>
  </div>
</div>

</footer>
  
<script type="text/javascript">

(function (w, d) {
  var j, s = d.getElementsByTagName('script')[0],
  a = function (u, i) {
    if (!d.getElementById(i)) {
      j = d.createElement('script');
      j.src = u;
      if (i) {j.id = i;}
      s.parentNode.insertBefore(j, s);
    }
  };
  
  
  
  
  
  
  
  
  
  
})(this, document);
</script>




</body>
</html>
